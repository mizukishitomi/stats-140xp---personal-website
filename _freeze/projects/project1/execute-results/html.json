{
  "hash": "bc8978a98171ea47cf24c6473a7a0304",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Monopoly Project\"\nformat: html\n---\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# source(\"solutions.R\")  # edit with your file name\nsource(\"102A_hw_04_script_Mizuki_Shitomi.R\")  # edit with your file name\nprint(Player)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<Player> object generator\n  Public:\n    pos: 1\n    verbose: TRUE\n    in_jail: FALSE\n    was_in_jail: FALSE\n    rounds_in_jail: 0\n    double_straight: 0\n    move_fwd: function (n) \n    initialize: function (verbose = FALSE, pos = 1) \n    jail_turn: function () \n    double_turn: function () \n    chance_movement: function (card) \n    clone: function (deep = FALSE) \n  Parent env: <environment: R_GlobalEnv>\n  Locked objects: TRUE\n  Locked class: FALSE\n  Portable: TRUE\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(take_turn)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nfunction (player, spacetracker) \n{\n    dice_rolls <- dice$roll()\n    double <- dice_rolls[1] == dice_rolls[2]\n    player$double_straight <- 0\n    player$was_in_jail <- player$in_jail\n    if (player$was_in_jail) {\n        if (double | player$rounds_in_jail == 2) {\n            player$in_jail <- FALSE\n            if (player$verbose & double) {\n                cat(\"In jail but rolled doubles.\\n\")\n            }\n            else if (player$verbose & player$rounds_in_jail == \n                2) {\n                cat(\"Player's third turn in jail. Player must exit jail.\\n\")\n            }\n            player$rounds_in_jail <- 0\n            if (player$verbose) {\n                cat(\"Player exits jail.\\n\")\n            }\n            player$move_fwd(sum(dice_rolls))\n            spacetracker$tally(player$pos)\n        }\n        else {\n            player$jail_turn()\n            if (player$verbose) {\n                cat(\"Player stays in jail.\\n\")\n            }\n            spacetracker$tally(player$pos)\n        }\n    }\n    while (double & !player$was_in_jail) {\n        player$double_turn()\n        if (player$verbose) {\n            cat(\"Doubles count is now \", player$double_straight, \n                \".\\n\", sep = \"\")\n        }\n        if (player$double_straight < 3) {\n            player$move_fwd(sum(dice_rolls))\n            if (player$pos %in% c(3, 18, 34)) {\n                spacetracker$tally(player$pos)\n                if (player$verbose) {\n                  cat(\"Draw a Community Chest card.\\n\")\n                }\n                card_index <- community$draw()\n                card <- communitydeck[card_index, \"card\"]\n                if (card == \"Advance to Go\") {\n                  player$pos <- 1\n                  if (player$verbose) {\n                    cat(\"Player moves to\", player$pos, \": \", \n                      gameboard$title[player$pos], \".\\n\", sep = \"\")\n                  }\n                  spacetracker$tally(player$pos)\n                }\n                else if (card == \" Go to Jail\") {\n                  player$pos <- 11\n                  player$in_jail <- TRUE\n                  if (player$verbose) {\n                    cat(\"Player goes to jail.\\n\")\n                  }\n                  spacetracker$tally(player$pos)\n                  break\n                }\n            }\n            else if (player$pos %in% c(8, 23, 37)) {\n                spacetracker$tally(player$pos)\n                if (player$verbose) {\n                  cat(\"Draw a Chance card.\\n\")\n                }\n                card_index <- chance$draw()\n                card <- chancedeck[card_index, \"card\"]\n                player$chance_movement(card)\n                if (card %in% chancedeck$card[1:9]) {\n                  spacetracker$tally(player$pos)\n                }\n                if (card %in% chancedeck$card[8]) {\n                  break\n                }\n            }\n            else if (player$pos == 31) {\n                player$pos <- 11\n                player$in_jail <- TRUE\n                if (player$verbose) {\n                  cat(\"Player goes to jail.\\n\")\n                }\n                spacetracker$tally(player$pos)\n                break\n            }\n            else {\n                spacetracker$tally(player$pos)\n            }\n            if (player$verbose) {\n                cat(\"\\nPlayer rolled doubles, so they take another turn.\\n\")\n            }\n            dice_rolls <- dice$roll()\n            double <- dice_rolls[1] == dice_rolls[2]\n        }\n        else {\n            if (player$verbose) {\n                cat(\"Player goes to jail.\\n\")\n            }\n            player$double_straight <- 0\n            player$pos <- 11\n            player$in_jail <- TRUE\n            spacetracker$tally(player$pos)\n            break\n        }\n    }\n    if (!double & !player$was_in_jail) {\n        player$move_fwd(sum(dice_rolls))\n    }\n    if (player$pos == 31) {\n        player$pos <- 11\n        player$in_jail <- TRUE\n        if (player$verbose) {\n            cat(\"Player goes to jail.\\n\")\n        }\n        spacetracker$tally(player$pos)\n    }\n    else if (player$pos %in% c(3, 18, 34)) {\n        spacetracker$tally(player$pos)\n        if (player$verbose) {\n            cat(\"Draw a Community Chest card.\\n\")\n        }\n        card_index <- community$draw()\n        card <- communitydeck[card_index, \"card\"]\n        if (card == communitydeck$card[1]) {\n            player$pos <- 1\n            if (player$verbose) {\n                cat(\"Player moves to\", player$pos, \": \", gameboard$title[player$pos], \n                  \".\\n\", sep = \"\")\n            }\n            spacetracker$tally(player$pos)\n        }\n        else if (card == communitydeck$card[2]) {\n            player$pos <- 11\n            player$in_jail <- TRUE\n            if (player$verbose) {\n                cat(\"Player goes to jail.\\n\")\n            }\n            spacetracker$tally(player$pos)\n        }\n    }\n    else if (player$pos %in% c(8, 23, 37)) {\n        spacetracker$tally(player$pos)\n        if (player$verbose) {\n            cat(\"Draw a Chance card.\\n\")\n        }\n        card_index <- chance$draw()\n        card <- chancedeck[card_index, \"card\"]\n        player$chance_movement(card)\n        if (card %in% chancedeck$card[1:9]) {\n            spacetracker$tally(player$pos)\n        }\n    }\n    else if (player$was_in_jail == FALSE & player$in_jail == \n        FALSE) {\n        spacetracker$tally(player$pos)\n    }\n}\n```\n\n\n:::\n:::\n\n\n\\pagebreak\n\n# Part 1: Test Cases\n\n## do not alter the code for the test cases\n\n### Test Case 1: Space: Go to Jail\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndice <- PresetDice$new(\n  rolls = c(3,4),\n  verbose = TRUE\n)\nset.seed(16)\nplayer1 <- Player$new(verbose = TRUE, pos = 24)\nmonopoly <- SpaceTracker$new(verbose = TRUE)\n\nfor (i in 1:1) {\n  cat(\"--- Turn\", i,\"---\\n\")\n  take_turn(player1, monopoly)\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n--- Turn 1 ---\nDice Rolled: 3 4 \nPlayer starts at 24: Indiana Avenue.\nPlayer moves forward 7.\nPlayer is now at 31: Go to jail.\nPlayer goes to jail.\nAdded tally to 11: Jail.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(setNames(monopoly$counts, 1:40))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \n 0  0  0  0  0  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0  0  0  0  0  0  0 \n27 28 29 30 31 32 33 34 35 36 37 38 39 40 \n 0  0  0  0  0  0  0  0  0  0  0  0  0  0 \n```\n\n\n:::\n:::\n\n\n\\pagebreak\n\n### Test Case 2: Chance Card and Doubles Tests: Advance to Go, Reading Railroad, Nearest Railroad, Nearest Utility, No Movement\n\n\n::: {.cell}\n\n```{.r .cell-code}\ndice <- PresetDice$new(\n  rolls = c(3,4, 4,3, 1,1, 3,4, 5,3),\n  verbose = TRUE\n)\nset.seed(135)\nchance <- CardDeck$new(chancedeck, verbose = TRUE)\ncommunity <- CardDeck$new(communitydeck, verbose = TRUE)\nplayer1 <- Player$new(verbose = TRUE)\nmonopoly <- SpaceTracker$new(verbose = TRUE)\n\nfor (i in 1:4) {\n  cat(\"--- Turn\", i,\"---\\n\")\n  take_turn(player1, monopoly)\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n--- Turn 1 ---\nDice Rolled: 3 4 \nPlayer starts at 1: Go.\nPlayer moves forward 7.\nPlayer is now at 8: Chance.\nAdded tally to 8: Chance.\nDraw a Chance card.\nCard: Advance to Go \nPlayer moves to 1: Go.\nAdded tally to 1: Go.\n\n--- Turn 2 ---\nDice Rolled: 4 3 \nPlayer starts at 1: Go.\nPlayer moves forward 7.\nPlayer is now at 8: Chance.\nAdded tally to 8: Chance.\nDraw a Chance card.\nCard: Take a ride on the Reading Railroad \nPlayer moves to 6: Reading Railroad.\nAdded tally to 6: Reading Railroad.\n\n--- Turn 3 ---\nDice Rolled: 1 1 \nDoubles count is now 1.\nPlayer starts at 6: Reading Railroad.\nPlayer moves forward 2.\nPlayer is now at 8: Chance.\nAdded tally to 8: Chance.\nDraw a Chance card.\nCard: Advance token to the nearest Railroad \nPlayer moves to 16: Pennsylvania Railroad.\nAdded tally to 16: Pennsylvania Railroad.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 3 4 \nPlayer starts at 16: Pennsylvania Railroad.\nPlayer moves forward 7.\nPlayer is now at 23: Chance.\nAdded tally to 23: Chance.\nDraw a Chance card.\nCard: Advance token to nearest Utility \nPlayer moves to 29: Water Works.\nAdded tally to 29: Water Works.\n\n--- Turn 4 ---\nDice Rolled: 5 3 \nPlayer starts at 29: Water Works.\nPlayer moves forward 8.\nPlayer is now at 37: Chance.\nAdded tally to 37: Chance.\nDraw a Chance card.\nCard: Bank pays you dividend of $50 \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(setNames(monopoly$counts, 1:40))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \n 1  0  0  0  0  1  0  3  0  0  0  0  0  0  0  1  0  0  0  0  0  0  1  0  0  0 \n27 28 29 30 31 32 33 34 35 36 37 38 39 40 \n 0  0  1  0  0  0  0  0  0  0  1  0  0  0 \n```\n\n\n:::\n:::\n\n\\pagebreak\n\n### Test Case 3: Multiple doubles. Community Chest.\n\n::: {.cell}\n\n```{.r .cell-code}\ndice <- PresetDice$new(\n  rolls = c(3,3, 2,2, 2,1, 3,1), verbose = TRUE)\n\nplayer1 <- Player$new(verbose = TRUE)\nmonopoly <- SpaceTracker$new(verbose = TRUE)\nfor (i in 1:2) {\n  cat(\"--- Turn\", i,\"---\\n\")\n  take_turn(player1, monopoly)\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n--- Turn 1 ---\nDice Rolled: 3 3 \nDoubles count is now 1.\nPlayer starts at 1: Go.\nPlayer moves forward 6.\nPlayer is now at 7: Oriental Avenue.\nAdded tally to 7: Oriental Avenue.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 2 2 \nDoubles count is now 2.\nPlayer starts at 7: Oriental Avenue.\nPlayer moves forward 4.\nPlayer is now at 11: Jail.\nAdded tally to 11: Jail.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 2 1 \nPlayer starts at 11: Jail.\nPlayer moves forward 3.\nPlayer is now at 14: States Avenue.\nAdded tally to 14: States Avenue.\n\n--- Turn 2 ---\nDice Rolled: 3 1 \nPlayer starts at 14: States Avenue.\nPlayer moves forward 4.\nPlayer is now at 18: Community Chest.\nAdded tally to 18: Community Chest.\nDraw a Community Chest card.\nCard: Life insurance matures. Collect $100 \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(setNames(monopoly$counts, 1:40))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \n 0  0  0  0  0  0  1  0  0  0  1  0  0  1  0  0  0  1  0  0  0  0  0  0  0  0 \n27 28 29 30 31 32 33 34 35 36 37 38 39 40 \n 0  0  0  0  0  0  0  0  0  0  0  0  0  0 \n```\n\n\n:::\n:::\n\n\n\\pagebreak\n\n### Test Case 4: Doubles three times. Three turns in jail.\n\n::: {.cell}\n\n```{.r .cell-code}\ndice <- PresetDice$new(\n  rolls = c(3,3, 3,3, 3,3, 5,6, 5,6, 5,6),\n  verbose = TRUE\n)\n\nplayer1 <- Player$new(verbose = TRUE)\nmonopoly <- SpaceTracker$new(verbose = TRUE)\n\nfor (i in 1:4) {\n  cat(\"--- Turn\", i,\"---\\n\")\n  take_turn(player1, monopoly)\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n--- Turn 1 ---\nDice Rolled: 3 3 \nDoubles count is now 1.\nPlayer starts at 1: Go.\nPlayer moves forward 6.\nPlayer is now at 7: Oriental Avenue.\nAdded tally to 7: Oriental Avenue.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 3 3 \nDoubles count is now 2.\nPlayer starts at 7: Oriental Avenue.\nPlayer moves forward 6.\nPlayer is now at 13: Electric Company.\nAdded tally to 13: Electric Company.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 3 3 \nDoubles count is now 3.\nPlayer goes to jail.\nAdded tally to 11: Jail.\n\n--- Turn 2 ---\nDice Rolled: 5 6 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 3 ---\nDice Rolled: 5 6 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 4 ---\nDice Rolled: 5 6 \nPlayer's third turn in jail. Player must exit jail.\nPlayer exits jail.\nPlayer starts at 11: Jail.\nPlayer moves forward 11.\nPlayer is now at 22: Kentucky Avenue.\nAdded tally to 22: Kentucky Avenue.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(setNames(monopoly$counts, 1:40))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \n 0  0  0  0  0  0  1  0  0  0  3  0  1  0  0  0  0  0  0  0  0  1  0  0  0  0 \n27 28 29 30 31 32 33 34 35 36 37 38 39 40 \n 0  0  0  0  0  0  0  0  0  0  0  0  0  0 \n```\n\n\n:::\n:::\n\n\n\\pagebreak\n\n### Test Case 5: After going to Jail, player's turn ends immediately. Rolling doubles while in Jail gets player out of jail.\n\n::: {.cell}\n\n```{.r .cell-code}\ndice <- PresetDice$new(\n  rolls = c(3,3, 1,2, 3,3, 3,4),\n  verbose = TRUE\n)\n\nplayer1 <- Player$new(verbose = TRUE, pos = 25)\nmonopoly <- SpaceTracker$new(verbose = TRUE)\n\nfor (i in 1:3) {\n  cat(\"--- Turn\", i,\"---\\n\")\n  take_turn(player1, monopoly)\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n--- Turn 1 ---\nDice Rolled: 3 3 \nDoubles count is now 1.\nPlayer starts at 25: Illinois Avenue.\nPlayer moves forward 6.\nPlayer is now at 31: Go to jail.\nPlayer goes to jail.\nAdded tally to 11: Jail.\n\n--- Turn 2 ---\nDice Rolled: 1 2 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 3 ---\nDice Rolled: 3 3 \nIn jail but rolled doubles.\nPlayer exits jail.\nPlayer starts at 11: Jail.\nPlayer moves forward 6.\nPlayer is now at 17: St. James Place.\nAdded tally to 17: St. James Place.\n```\n\n\n:::\n\n```{.r .cell-code}\nprint(setNames(monopoly$counts, 1:40))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n 1  2  3  4  5  6  7  8  9 10 11 12 13 14 15 16 17 18 19 20 21 22 23 24 25 26 \n 0  0  0  0  0  0  0  0  0  0  2  0  0  0  0  0  1  0  0  0  0  0  0  0  0  0 \n27 28 29 30 31 32 33 34 35 36 37 38 39 40 \n 0  0  0  0  0  0  0  0  0  0  0  0  0  0 \n```\n\n\n:::\n:::\n\n\n\\pagebreak\n\n### Test Case 6: 20 Predetermined Turns\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## You must use these dice for Part 1\ndice <- PresetDice$new(\n  rolls = c(6,4, 5,3, 3,5, 4,4, 4,4, 2,2, 4,3, 4,4, 1,4,\n            3,4, 1,2, 3,6, 5,4, 5,5, 1,2, 5,4, 3,3, 6,1,\n            1,1, 2,3, 5,5, 5,4, 4,1, 2,2, 2,4),\n  verbose = TRUE\n)\nset.seed(2)\nchance <- CardDeck$new(chancedeck, verbose = TRUE)\ncommunity <- CardDeck$new(communitydeck, verbose = TRUE)\n# if your chance cards different from mine,\n# check to make sure sample(15) returns the following\n# > set.seed(2)\n# > sample(15)\n#  [1]  5  6 14  8  1 11  9  2  3 10  7 12  4 13 15\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nplayer1 <- Player$new(verbose = TRUE)\nmonopoly <- SpaceTracker$new(verbose = TRUE)\n\nfor (i in 1:20) {\n  cat(\"--- Turn\", i,\"---\\n\")\n  take_turn(player1, monopoly)\n  cat(\"\\n\")\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n--- Turn 1 ---\nDice Rolled: 6 4 \nPlayer starts at 1: Go.\nPlayer moves forward 10.\nPlayer is now at 11: Jail.\nAdded tally to 11: Jail.\n\n--- Turn 2 ---\nDice Rolled: 5 3 \nPlayer starts at 11: Jail.\nPlayer moves forward 8.\nPlayer is now at 19: Tennessee Avenue.\nAdded tally to 19: Tennessee Avenue.\n\n--- Turn 3 ---\nDice Rolled: 3 5 \nPlayer starts at 19: Tennessee Avenue.\nPlayer moves forward 8.\nPlayer is now at 27: Atlantic Avenue.\nAdded tally to 27: Atlantic Avenue.\n\n--- Turn 4 ---\nDice Rolled: 4 4 \nDoubles count is now 1.\nPlayer starts at 27: Atlantic Avenue.\nPlayer moves forward 8.\nPlayer is now at 35: Pennsylvania Avenue.\nAdded tally to 35: Pennsylvania Avenue.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 4 4 \nDoubles count is now 2.\nPlayer starts at 35: Pennsylvania Avenue.\nPlayer moves forward 8.\nPlayer is now at 3: Community Chest.\nAdded tally to 3: Community Chest.\nDraw a Community Chest card.\nCard: You have won second prize in a beauty contest \n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 2 2 \nDoubles count is now 3.\nPlayer goes to jail.\nAdded tally to 11: Jail.\n\n--- Turn 5 ---\nDice Rolled: 4 3 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 6 ---\nDice Rolled: 4 4 \nIn jail but rolled doubles.\nPlayer exits jail.\nPlayer starts at 11: Jail.\nPlayer moves forward 8.\nPlayer is now at 19: Tennessee Avenue.\nAdded tally to 19: Tennessee Avenue.\n\n--- Turn 7 ---\nDice Rolled: 1 4 \nPlayer starts at 19: Tennessee Avenue.\nPlayer moves forward 5.\nPlayer is now at 24: Indiana Avenue.\nAdded tally to 24: Indiana Avenue.\n\n--- Turn 8 ---\nDice Rolled: 3 4 \nPlayer starts at 24: Indiana Avenue.\nPlayer moves forward 7.\nPlayer is now at 31: Go to jail.\nPlayer goes to jail.\nAdded tally to 11: Jail.\n\n--- Turn 9 ---\nDice Rolled: 1 2 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 10 ---\nDice Rolled: 3 6 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 11 ---\nDice Rolled: 5 4 \nPlayer's third turn in jail. Player must exit jail.\nPlayer exits jail.\nPlayer starts at 11: Jail.\nPlayer moves forward 9.\nPlayer is now at 20: New York Avenue.\nAdded tally to 20: New York Avenue.\n\n--- Turn 12 ---\nDice Rolled: 5 5 \nDoubles count is now 1.\nPlayer starts at 20: New York Avenue.\nPlayer moves forward 10.\nPlayer is now at 30: Marvin Gardens.\nAdded tally to 30: Marvin Gardens.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 1 2 \nPlayer starts at 30: Marvin Gardens.\nPlayer moves forward 3.\nPlayer is now at 33: North Carolina Avenue.\nAdded tally to 33: North Carolina Avenue.\n\n--- Turn 13 ---\nDice Rolled: 5 4 \nPlayer starts at 33: North Carolina Avenue.\nPlayer moves forward 9.\nPlayer is now at 2: Mediterranean Avenue.\nAdded tally to 2: Mediterranean Avenue.\n\n--- Turn 14 ---\nDice Rolled: 3 3 \nDoubles count is now 1.\nPlayer starts at 2: Mediterranean Avenue.\nPlayer moves forward 6.\nPlayer is now at 8: Chance.\nAdded tally to 8: Chance.\nDraw a Chance card.\nCard: Advance token to the nearest Railroad \nPlayer moves to 16: Pennsylvania Railroad.\nAdded tally to 16: Pennsylvania Railroad.\n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 6 1 \nPlayer starts at 16: Pennsylvania Railroad.\nPlayer moves forward 7.\nPlayer is now at 23: Chance.\nAdded tally to 23: Chance.\nDraw a Chance card.\nCard: Take a ride on the Reading Railroad \nPlayer moves to 6: Reading Railroad.\nAdded tally to 6: Reading Railroad.\n\n--- Turn 15 ---\nDice Rolled: 1 1 \nDoubles count is now 1.\nPlayer starts at 6: Reading Railroad.\nPlayer moves forward 2.\nPlayer is now at 8: Chance.\nAdded tally to 8: Chance.\nDraw a Chance card.\nCard: You have been elected Chairman of the Board \n\nPlayer rolled doubles, so they take another turn.\nDice Rolled: 2 3 \nPlayer starts at 8: Chance.\nPlayer moves forward 5.\nPlayer is now at 13: Electric Company.\nAdded tally to 13: Electric Company.\n\n--- Turn 16 ---\nDice Rolled: 5 5 \nDoubles count is now 1.\nPlayer starts at 13: Electric Company.\nPlayer moves forward 10.\nPlayer is now at 23: Chance.\nAdded tally to 23: Chance.\nDraw a Chance card.\nCard: Go to Jail \nPlayer goes to jail.\nAdded tally to 11: Jail.\n\n--- Turn 17 ---\nDice Rolled: 5 4 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 18 ---\nDice Rolled: 4 1 \nPlayer stays in jail.\nAdded tally to 11: Jail.\n\n--- Turn 19 ---\nDice Rolled: 2 2 \nIn jail but rolled doubles.\nPlayer exits jail.\nPlayer starts at 11: Jail.\nPlayer moves forward 4.\nPlayer is now at 15: Virginia Avenue.\nAdded tally to 15: Virginia Avenue.\n\n--- Turn 20 ---\nDice Rolled: 2 4 \nPlayer starts at 15: Virginia Avenue.\nPlayer moves forward 6.\nPlayer is now at 21: Free Parking.\nAdded tally to 21: Free Parking.\n```\n\n\n:::\n\n```{.r .cell-code}\nmonopoly$counts\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n [1] 0 1 1 0 0 1 0 2 0 0 9 0 1 0 1 1 0 0 2 1 1 0 2 1 0 0 1 0 0 1 0 0 1 0 1 0 0 0\n[39] 0 0\n```\n\n\n:::\n\n```{.r .cell-code}\ncbind(gameboard, counts = monopoly$counts)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   space                 title counts\n1      1                    Go      0\n2      2  Mediterranean Avenue      1\n3      3       Community Chest      1\n4      4         Baltic Avenue      0\n5      5            Income Tax      0\n6      6      Reading Railroad      1\n7      7       Oriental Avenue      0\n8      8                Chance      2\n9      9        Vermont Avenue      0\n10    10    Connecticut Avenue      0\n11    11                  Jail      9\n12    12     St. Charles Place      0\n13    13      Electric Company      1\n14    14         States Avenue      0\n15    15       Virginia Avenue      1\n16    16 Pennsylvania Railroad      1\n17    17       St. James Place      0\n18    18       Community Chest      0\n19    19      Tennessee Avenue      2\n20    20       New York Avenue      1\n21    21          Free Parking      1\n22    22       Kentucky Avenue      0\n23    23                Chance      2\n24    24        Indiana Avenue      1\n25    25       Illinois Avenue      0\n26    26        B & O Railroad      0\n27    27       Atlantic Avenue      1\n28    28        Ventnor Avenue      0\n29    29           Water Works      0\n30    30        Marvin Gardens      1\n31    31            Go to jail      0\n32    32        Pacific Avenue      0\n33    33 North Carolina Avenue      1\n34    34       Community Chest      0\n35    35   Pennsylvania Avenue      1\n36    36   Short Line Railroad      0\n37    37                Chance      0\n38    38            Park Place      0\n39    39            Luxury Tax      0\n40    40             Boardwalk      0\n```\n\n\n:::\n:::\n\n\n\n# Part 2: 1000 simulated games\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dplyr)\n```\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n## Use non-verbose random dice for Part 2\nset.seed(2)\nchance <- CardDeck$new(chancedeck, verbose = FALSE)\ncommunity <- CardDeck$new(communitydeck, verbose = FALSE)\ndice <- RandomDice$new()\n\nplayer1 <- Player$new(verbose = FALSE)\nplayer2 <- Player$new(verbose = FALSE)\nmonopoly <- SpaceTracker$new(verbose = FALSE)\n\nfor (g in 1:1000) {\n  if (g %% 100 == 0) {\n    cat(\"#### SIMULATING GAME\", g, \"##### \\n\")\n  }\n  for (i in 1:150) {\n    take_turn(player1, monopoly)\n    take_turn(player2, monopoly)\n  }\n  # add code for renewing the game\n  chance <- CardDeck$new(chancedeck, verbose = FALSE)\n  community <- CardDeck$new(communitydeck, verbose = FALSE)\n}\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n#### SIMULATING GAME 100 ##### \n#### SIMULATING GAME 200 ##### \n#### SIMULATING GAME 300 ##### \n#### SIMULATING GAME 400 ##### \n#### SIMULATING GAME 500 ##### \n#### SIMULATING GAME 600 ##### \n#### SIMULATING GAME 700 ##### \n#### SIMULATING GAME 800 ##### \n#### SIMULATING GAME 900 ##### \n#### SIMULATING GAME 1000 ##### \n```\n\n\n:::\n\n```{.r .cell-code}\nprint(setNames(monopoly$counts, 1:40))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n    1     2     3     4     5     6     7     8     9    10    11    12    13 \n10515  6994  7208  7249  7640  9563  7552  7726  7661  7554 39865  9053  9299 \n   14    15    16    17    18    19    20    21    22    23    24    25    26 \n 7673  8661  8823  9350 10765  9820  9870  9858  9105 10596  9024 10685  9621 \n   27    28    29    30    31    32    33    34    35    36    37    38    39 \n 8955  8747  9328  8529     0  8743  8729  8895  8170  8046  7585  7195  7196 \n   40 \n 8727 \n```\n\n\n:::\n\n```{.r .cell-code}\nresults <- cbind(gameboard, tally = monopoly$counts)\nresults <- cbind(results, rel = monopoly$counts/sum(monopoly$counts))\nprint(results)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   space                 title tally        rel\n1      1                    Go 10515 0.02837482\n2      2  Mediterranean Avenue  6994 0.01887337\n3      3       Community Chest  7208 0.01945085\n4      4         Baltic Avenue  7249 0.01956149\n5      5            Income Tax  7640 0.02061661\n6      6      Reading Railroad  9563 0.02580584\n7      7       Oriental Avenue  7552 0.02037914\n8      8                Chance  7726 0.02084868\n9      9        Vermont Avenue  7661 0.02067328\n10    10    Connecticut Avenue  7554 0.02038454\n11    11                  Jail 39865 0.10757606\n12    12     St. Charles Place  9053 0.02442960\n13    13      Electric Company  9299 0.02509344\n14    14         States Avenue  7673 0.02070566\n15    15       Virginia Avenue  8661 0.02337179\n16    16 Pennsylvania Railroad  8823 0.02380895\n17    17       St. James Place  9350 0.02523106\n18    18       Community Chest 10765 0.02904945\n19    19      Tennessee Avenue  9820 0.02649936\n20    20       New York Avenue  9870 0.02663428\n21    21          Free Parking  9858 0.02660190\n22    22       Kentucky Avenue  9105 0.02456993\n23    23                Chance 10596 0.02859340\n24    24        Indiana Avenue  9024 0.02435135\n25    25       Illinois Avenue 10685 0.02883357\n26    26        B & O Railroad  9621 0.02596236\n27    27       Atlantic Avenue  8955 0.02416515\n28    28        Ventnor Avenue  8747 0.02360386\n29    29           Water Works  9328 0.02517169\n30    30        Marvin Gardens  8529 0.02301558\n31    31            Go to jail     0 0.00000000\n32    32        Pacific Avenue  8743 0.02359306\n33    33 North Carolina Avenue  8729 0.02355529\n34    34       Community Chest  8895 0.02400324\n35    35   Pennsylvania Avenue  8170 0.02204682\n36    36   Short Line Railroad  8046 0.02171220\n37    37                Chance  7585 0.02046819\n38    38            Park Place  7195 0.01941577\n39    39            Luxury Tax  7196 0.01941847\n40    40             Boardwalk  8727 0.02354989\n```\n\n\n:::\n\n```{.r .cell-code}\narrange(results, desc(tally))\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n   space                 title tally        rel\n1     11                  Jail 39865 0.10757606\n2     18       Community Chest 10765 0.02904945\n3     25       Illinois Avenue 10685 0.02883357\n4     23                Chance 10596 0.02859340\n5      1                    Go 10515 0.02837482\n6     20       New York Avenue  9870 0.02663428\n7     21          Free Parking  9858 0.02660190\n8     19      Tennessee Avenue  9820 0.02649936\n9     26        B & O Railroad  9621 0.02596236\n10     6      Reading Railroad  9563 0.02580584\n11    17       St. James Place  9350 0.02523106\n12    29           Water Works  9328 0.02517169\n13    13      Electric Company  9299 0.02509344\n14    22       Kentucky Avenue  9105 0.02456993\n15    12     St. Charles Place  9053 0.02442960\n16    24        Indiana Avenue  9024 0.02435135\n17    27       Atlantic Avenue  8955 0.02416515\n18    34       Community Chest  8895 0.02400324\n19    16 Pennsylvania Railroad  8823 0.02380895\n20    28        Ventnor Avenue  8747 0.02360386\n21    32        Pacific Avenue  8743 0.02359306\n22    33 North Carolina Avenue  8729 0.02355529\n23    40             Boardwalk  8727 0.02354989\n24    15       Virginia Avenue  8661 0.02337179\n25    30        Marvin Gardens  8529 0.02301558\n26    35   Pennsylvania Avenue  8170 0.02204682\n27    36   Short Line Railroad  8046 0.02171220\n28     8                Chance  7726 0.02084868\n29    14         States Avenue  7673 0.02070566\n30     9        Vermont Avenue  7661 0.02067328\n31     5            Income Tax  7640 0.02061661\n32    37                Chance  7585 0.02046819\n33    10    Connecticut Avenue  7554 0.02038454\n34     7       Oriental Avenue  7552 0.02037914\n35     4         Baltic Avenue  7249 0.01956149\n36     3       Community Chest  7208 0.01945085\n37    39            Luxury Tax  7196 0.01941847\n38    38            Park Place  7195 0.01941577\n39     2  Mediterranean Avenue  6994 0.01887337\n40    31            Go to jail     0 0.00000000\n```\n\n\n:::\n:::\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# set colors for the bar plot\ncolor_vec <- rep(NA, 40)\ncolor_vec[c(2,4)] <- \"chocolate4\" # mediterranean, baltic\ncolor_vec[c(7,9,10)] <- \"lightskyblue\" # oriental, vermont, connecticut \ncolor_vec[c(12,14,15)] <- \"darkorchid2\" # st charles, states, virgina\ncolor_vec[c(17,19,20)] <- \"darkorange\" # st james, tennessee, new york\ncolor_vec[c(22,24,25)] <- \"red2\" # kentucky, indiana, illinois\ncolor_vec[c(27,28,30)] <- \"gold1\" # atlantic, ventnor, marvin\ncolor_vec[c(32,33,35)] <- \"darkgreen\" # pacific, n. carolina, pennsylvania\ncolor_vec[c(38,40)] <- \"blue3\" # park place, boardwalk\ncolor_vec[c(6,16,26,36)] <- \"gray14\" # railroads\ncolor_vec[c(13,29)] <- \"palegreen1\" # utilities\ncolor_vec[c(8,23,37)] <- \"salmon2\" # chance\ncolor_vec[c(3,18,34)] <- \"deepskyblue\" # community chest \n\nbarplot(monopoly$counts, \n  main = \"Barplot of Frequency of Landing for Each Space\",\n  xlab = \"Space Number\", ylab = \"Number of Landings\",\n  las = 2, col = color_vec, names.arg = 1:40, cex.names = 0.65)\n```\n\n::: {.cell-output-display}\n![](project1_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# this one sets the y-limits so the max count of jail doesn't shrink everything\nbarplot(monopoly$counts, \n  main = \"Barplot of Frequency of Landing for Each Space\",\n  xlab = \"Space Number\", ylab = \"Number of Landings\",\n  las = 2, col = color_vec, names.arg = 1:40, cex.names = 0.65,\n  ylim = c(0, sort(monopoly$counts, decreasing = TRUE)[2]))\n```\n\n::: {.cell-output-display}\n![](project1_files/figure-html/unnamed-chunk-11-2.png){width=672}\n:::\n:::\n\n\n",
    "supporting": [
      "project1_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}